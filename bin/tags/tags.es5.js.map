{"version":3,"sources":["tags.js"],"names":[],"mappings":"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","file":"tags.es5.js","sourcesContent":["riot.tag2('gp-colorpicker', '<div class=\"colorlist\"><div class=\"color\" each=\"{color in colorList.concat(customColors)}\"><div class=\"colordot\" riot-style=\"background-color:{color}\" onclick=\"{selectColor}\"></div></div><div class=\"color\"><div class=\"colordot new\" onclick=\"{showColorWheel}\"></div></div></div><div class=\"picker {ispickerShown?\\'shown\\':\\'\\'}\"><div class=\"bg\"></div><div class=\"wheelcontainer\"><canvas id=\"picker\" if=\"{showWheel}\" height=\"300\" width=\"{window.innerWidth}\" ontouchmove=\"{getColor}\" ontouchstart=\"{getColor}\"></canvas><div class=\"selector\" riot-style=\"background-color:{selectedColor}\" onclick=\"{colorSelectionDone}\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"></path></svg></div></div></div>', '', '', function(opts) {\n\t\tvar self=this;\n\t\tvar context;\n\t\tvar heightFactor=window.innerHeight-300;\n\n\t\tthis.customColors=[];\n\n\t\tif(localStorage.customColors){\n\t\t\tself.update({customColors:JSON.parse(localStorage.customColors)});\n\t\t}\n\n\t\tthis.colorList =[\"rgb(255,255,255)\", \"rgb(0,0,0)\", \"rgb(148,0,211)\", \"rgb(75,0,130)\", \"rgb(0,0,255)\", \"rgb(0,255,0)\", \"rgb(255,255,0)\", \"rgb(255,127,0)\"];\n\t\tthis.ispickerShown=false;\n\t\tthis.pickerLeft=0;\n\t\tthis.pickerTop=0;\n\t\tthis.showWheel=false;\n\t\tthis.selectedColor=\"tomato\";\n\n\t\tfunction makeColorWheel(){\n\t\t\tvar canvas = document.getElementById(\"picker\");\n\t\t\tcontext = canvas.getContext(\"2d\");\n\t\t\tvar x = canvas.width / 2;\n\t\t\tvar y = canvas.height / 2;\n\t\t\tvar radius = 100;\n\t\t\tvar counterClockwise = false;\n\n\t\t\tfor(var angle=0; angle<=360; angle+=1){\n\t\t\t    var startAngle = (angle-2)*Math.PI/180;\n\t\t\t    var endAngle = angle * Math.PI/180;\n\t\t\t    context.beginPath();\n\t\t\t    context.moveTo(x, y);\n\t\t\t    context.arc(x, y, radius, startAngle, endAngle, counterClockwise);\n\t\t\t    context.closePath();\n\t\t\t    var gradient = context.createRadialGradient(x, y, 0, x, y, radius);\n\t\t\t\tgradient.addColorStop(0,'hsl('+angle+', 10%, 100%)');\n\t\t\t\tgradient.addColorStop(1,'hsl('+angle+', 100%, 50%)');\n\t\t\t    context.fillStyle = gradient;\n\t\t\t    context.fill();\n\t\t\t}\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(x, y);\n\t\t\tcontext.arc(x, y, radius/1.5, 0, 2*Math.PI);\n\t\t\tcontext.closePath();\n\t\t\tcontext.fillStyle = '#263238';\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tthis.on(\"mount\",(e)=>{\n\t\t\tself.update({ispickerShown:false});\n\t\t\tsetTimeout(function(){\n\t\t\t\tself.update({showWheel:true});\n\t\t\t\tmakeColorWheel();\n\t\t\t},800);\n\t\t});\n\n\t\tthis.selectColor=function(e){\n\t\t\tself.opts.onselectchange&&self.opts.onselectchange(e.target.style.backgroundColor);\n\t\t}\n\n\t\tthis.showColorWheel=function(e){\n\t\t\tself.update({ispickerShown:true});\n\t\t}\n\n\t\tthis.colorSelectionDone=function(e){\n\t\t\tvar tempArr=self.customColors;\n\t\t\ttempArr.push(self.selectedColor);\n\n\t\t\tself.update({\n\t\t\t\tcustomColors:tempArr,\n\t\t\t\tispickerShown:false\n\t\t\t});\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tlocalStorage.customColors=JSON.stringify(tempArr);\n\t\t\t},1);\n\t\t}\n\n\t\tthis.getColor=function(e){\n\t\t\tvar data=context.getImageData(e.touches[0].clientX, e.touches[0].clientY-heightFactor, 1, 1).data;\n\t\t\tif(!(data[0]===255&&data[1]===255&&data[2]===255)&&!(data[0]===38&&data[1]===50&&data[2]===56)&&!(data[0]===0&&data[1]===0&&data[2]===0)){\n\t\t\t\tself.update({selectedColor:'rgb('+data[0]+','+data[1]+','+data[2]+')'});\n\t\t\t}\n\t\t}\n});\nriot.tag2('gp-contriimage', '<img if=\"{loadedImagesCount===2}\" riot-src=\"{opts.bgImage}\" class=\"foreground\" height=\"{opts.height}\"></img><img if=\"{loadedImagesCount===2}\" riot-src=\"{opts.editImage}\" class=\"background\" height=\"{opts.height}\"></img><icon-pic></icon-pic>', '', '', function(opts) {\n\t\tthis.loadedImagesCount=0;\n\t\tthis.imgLoaded=function(e){\n\t\t\tself.update({loadedImagesCount:loadedImagesCount+1});\n\t\t}\n});\nriot.tag2('gp-draw', '<div class=\"canvascontainer\"><canvas if=\"{showCanvas}\" id=\"canvas\" width=\"800\" height=\"800\"></canvas></div><div class=\"pbar\" if=\"{isSaving}\"><material-progressbar progress=\"{0.5}\" moving=\"{true}\"></material-progressbar></div><div if=\"{!isSaving}\" class=\"controls {isControlsOpen?\\'controlsshown\\':\\'\\'}\"><button class=\"btn-control colors\" onclick=\"{showColors}\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z\"></path><path d=\"M0 0h24v24H0z\" fill=\"none\"></path></svg></button><button class=\"btn-control brush\" onclick=\"{showBrushes}\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34c-.39-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z\"></path></svg></button><button class=\"btn-control save\" onclick=\"{save}\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\"></path></svg></button><button class=\"btn-control save\" onclick=\"{save}\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\"></path></svg></button><button class=\"btn-control publish\" onclick=\"{publish}\"><icon-publish></icon-publish></button><button class=\"btn-control options {isControlsOpen?\\'controlsshown\\':\\'\\'}\" onclick=\"{openControls}\"><svg class=\"firstleg leg\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"></path></svg><svg class=\"secondleg leg\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"></path></svg></button></div><div class=\"bottomsheet {isBottomsheetShown?\\'shown\\':\\'\\'}\"><button class=\"btn-control closesheet\" onclick=\"{closeSheet}\"><svg class=\"firstleg leg\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"></path></svg><svg class=\"secondleg leg\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"></path></svg></button><div class=\"title\">{sheetTitle}</div><div class=\"sheetcontent\"><gp-colorpicker if=\"{currentControl===⁗PALLETE⁗}\" onselectchange=\"{selectColor}\"></gp-colorpicker><div class=\"brushlist\" if=\"{currentControl===⁗BRUSHES⁗}\"><div class=\"brushcontrol\" each=\"{brush in brushesList}\" onclick=\"{selectBrush}\"> {brush} </div></div></div><material-dialog title=\"Publish image\" shown=\"{isPublishPopupShown}\" actions=\"{[\\'CANCEL\\',\\'PUBLISH\\']}\" onaction=\"{popupaction}\"><div><material-input placeholder=\"enter title\" required valuechanged=\"{this.parent.changeTitle}\"></material-input><material-input placeholder=\"enter description\" required valuechanged=\"{this.parent.changeDesc}\"></material-input></div></material-dialog></div>', '', '', function(opts) {\n    var self = this;\n    var imageActions = veronica.flux.Actions.getAction(\"ImageActions\");\n    var userStore = veronica.flux.Stores.getStore(\"UserStore\");\n    var imgStore = veronica.flux.Stores.getStore(\"ImageStore\");\n\n    this.brushesList = [\n        \"Simple Pencil\",\n        \"Simple Brush\",\n        \"Air Brush\",\n        \"Slice Brush\",\n        \"Radial Brush\",\n        \"Pen Multi Stroke Brush\",\n        \"Spray\"\n    ];\n\n    this.isSaving = false;\n    this.isControlsOpen = false;\n    this.isBottomsheetShown = false;\n    this.currentControl = \"\";\n    this.sheetTitle = \"\";\n    this.showingTitleInput = false;\n    this.isPublishPopupShown = false;\n    this.imgId = null;\n\n    this.title=\"\";\n    this.description=\"\";\n\n    var el, ctx;\n    var factor = 800 / window.innerWidth;\n    var selectedBrush = \"Simple Pencil\";\n    var currentColor = \"rgb(0,0,0)\";\n    var lastPoint;\n\n    function getRandomInt(min, max) {\n        return Math.floor(Math.random() * (max - min + 1)) + min;\n    }\n\n    function startDraw(e) {\n        e.clientX = e.touches[0].clientX * factor;\n        e.clientY = (e.touches[0].clientY - 66) * factor;\n        ctx.beginPath();\n        ctx.strokeStyle = currentColor;\n        ctx.fillStyle = currentColor;\n        ctx.moveTo(e.clientX, e.clientY);\n        ctx.lineJoin = ctx.lineCap = 'round';\n        ctx.shadowColor = 'transparent';\n        ctx.lineWidth = 1;\n        switch (selectedBrush) {\n            case \"Simple Pencil\":\n                ctx.lineWidth = 1;\n                break;\n            case \"Simple Brush\":\n                ctx.lineWidth = 10;\n                break;\n            case \"Air Brush\":\n                ctx.lineWidth = 10;\n                ctx.shadowBlur = 10;\n                ctx.shadowColor = currentColor;\n                break;\n            case \"Pen Multi Stroke Brush\":\n            case \"Slice Brush\":\n                ctx.lineWidth = 4;\n                lastPoint = {\n                    x: e.clientX,\n                    y: e.clientY\n                };\n                break;\n        }\n    }\n\n    function draw(e) {\n        e.clientX = e.touches[0].clientX * factor;\n        e.clientY = (e.touches[0].clientY - 66) * factor;\n        switch (selectedBrush) {\n            case \"Radial Brush\":\n                var radgrad = ctx.createRadialGradient(e.clientX, e.clientY, 10, e.clientX, e.clientY, 20);\n                radgrad.addColorStop(0, currentColor);\n                radgrad.addColorStop(0.5, 'rgba(' + currentColor.substring(currentColor.indexOf('(') + 1, currentColor.indexOf(')')) + ',0.5)');\n                radgrad.addColorStop(1, 'transparent');\n                ctx.fillStyle = radgrad;\n                ctx.fillRect(e.clientX - 20, e.clientY - 20, 40, 40);\n                break;\n            case \"Pen Multi Stroke Brush\":\n                ctx.beginPath();\n                ctx.moveTo(lastPoint.x - getRandomInt(0, 2), lastPoint.y - getRandomInt(0, 2));\n                ctx.lineTo(e.clientX - getRandomInt(0, 2), e.clientY - getRandomInt(0, 2));\n                ctx.stroke();\n                ctx.moveTo(lastPoint.x, lastPoint.y);\n                ctx.lineTo(e.clientX, e.clientY);\n                ctx.stroke();\n                ctx.moveTo(lastPoint.x + getRandomInt(0, 2), lastPoint.y + getRandomInt(0, 2));\n                ctx.lineTo(e.clientX + getRandomInt(0, 2), e.clientY + getRandomInt(0, 2));\n                ctx.stroke();\n                lastPoint = {\n                    x: e.clientX,\n                    y: e.clientY\n                };\n                break;\n            case \"Slice Brush\":\n                ctx.beginPath();\n                ctx.globalAlpha = 1;\n                ctx.moveTo(lastPoint.x, lastPoint.y);\n                ctx.lineTo(e.clientX, e.clientY);\n                ctx.stroke();\n                ctx.moveTo(lastPoint.x - 4, lastPoint.y - 4);\n                ctx.lineTo(e.clientX - 4, e.clientY - 4);\n                ctx.stroke();\n                ctx.moveTo(lastPoint.x - 2, lastPoint.y - 2);\n                ctx.lineTo(e.clientX - 2, e.clientY - 2);\n                ctx.stroke();\n                ctx.moveTo(lastPoint.x + 2, lastPoint.y + 2);\n                ctx.lineTo(e.clientX + 2, e.clientY + 2);\n                ctx.stroke();\n                ctx.moveTo(lastPoint.x + 4, lastPoint.y + 4);\n                ctx.lineTo(e.clientX + 4, e.clientY + 4);\n                ctx.stroke();\n                lastPoint = {\n                    x: e.clientX,\n                    y: e.clientY\n                };\n                break;\n            default:\n                ctx.lineTo(e.touches[0].clientX * factor, (e.touches[0].clientY - 66) * factor);\n                ctx.stroke();\n        }\n    }\n\n    function endDraw(e) {\n        ctx.closePath();\n    }\n\n    function imageSaved() {\n        var imgId = imgStore.getCurrentPicId();\n        self.update({\n            isSaving: false,\n            imgId: imgId.image_id\n        });\n\n    }\n\n    function imageSaveFailed() {\n        self.update({\n            isSaving: false\n        });\n\n    }\n\n    function saveImage(){\n      imageActions.saveImage(self.imgId, el.toDataURL(), self.title, self.description, userStore.getSessionId());\n    }\n\n    this.openControls = function(e) {\n        e.preventDefault();\n        self.update({\n            isControlsOpen: !this.isControlsOpen\n        });\n    }\n\n    this.closeSheet = function(e) {\n        e && e.preventDefault();\n        self.update({\n            isBottomsheetShown: false,\n            currentControl: \"\",\n            sheetTitle: \"\",\n        });\n    }\n\n    this.showColors = function(e) {\n        e.preventDefault();\n        self.update({\n            isControlsOpen: !this.isControlsOpen,\n            isBottomsheetShown: true,\n            currentControl: \"PALLETE\",\n            sheetTitle: \"choose color\"\n        });\n    }\n\n    this.showBrushes = function(e) {\n        e.preventDefault();\n        self.update({\n            isControlsOpen: !this.isControlsOpen,\n            isBottomsheetShown: true,\n            currentControl: \"BRUSHES\",\n            sheetTitle: \"choose brush\"\n        });\n    }\n\n    this.selectBrush = function(e) {\n        selectedBrush = e.target.innerText;\n        this.closeSheet(e);\n    }\n\n    this.selectColor = function(e) {\n        currentColor = e;\n        self.closeSheet();\n    }\n\n    this.save = function(e) {\n        e.preventDefault();\n        this.closeSheet(e);\n        self.update({\n            isSaving: true,\n            isControlsOpen: false\n        });\n        saveImage();\n    }\n\n    this.publish = function(e){\n      e.preventDefault();\n      this.closeSheet(e);\n      self.update({\n          isPublishPopupShown: true,\n          isControlsOpen: false\n      });\n      saveImage();\n    }\n\n    this.changeTitle=function(e){\n      self.update({\n        title:e\n      });\n    }\n\n    this.changeDesc=function(e){\n      self.update({\n        description:e\n      });\n    }\n\n    this.popupaction=function(btnText){\n      switch(btnText){\n        case \"CANCEL\":\n          self.update({isPublishPopupShown: false});\n        case \"PUBLISH\":\n          saveImage();\n          imageActions.publishImage();\n      }\n    }\n\n    this.on(\"mount\", function() {\n        imgStore.subscribe(\"img:save:success\", imageSaved);\n        imgStore.subscribe(\"img:save:failed\", imageSaveFailed);\n\n        setTimeout(function() {\n            self.update({\n                showCanvas: true\n            });\n            selectedBrush = \"Simple Pencil\";\n            document.body.classList.add(\"noscroll\");\n            el = document.getElementById('canvas');\n            ctx = el.getContext('2d');\n            el.addEventListener(\"touchstart\", startDraw, false);\n            el.addEventListener(\"touchmove\", draw, false);\n            el.addEventListener(\"touchend\", endDraw, false);\n        }, 400);\n\n    });\n\n    this.on(\"unmount\", function() {\n        document.body.classList.remove(\"noscroll\");\n        imgStore.unsubscribe(\"img:save:success\", imageSaved);\n        imgStore.unsubscribe(\"img:save:failed\", imageSaveFailed);\n    });\n});\n\nriot.tag2('gp-header', '<div class=\"header {currState} {forceShow?\\'forceshow\\':\\'\\'}\"><div class=\"nav\"><button class=\"menu {isBackEnabled?\\'back\\':\\'\\'}\" onclick=\"{menuClick}\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path class=\"line line-first\" d=\"M3 18h18v-2H3v2zm0-5h18v\"></path><path class=\"line line-second\" d=\"M3 18h18v-2H3v2zm0-5h18v\"></path><path class=\"line line-third\" d=\"M3 18h18v-2H3v2zm0-5h18v\"></path></svg></button></div><div class=\"title\"><h1 class=\"titlefont\">kanvasProject</h1></div><div class=\"search\"><svg fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\" onclick=\"{goToSearch}\"><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path></svg></div></div>', '', '', function(opts) {\n\t\tvar self=this;\n\n\t\tvar navActions=veronica.flux.Actions.getAction(\"NavigationActions\");\n\t\tvar routeStore=veronica.flux.Stores.getStore(\"RouteStore\");\n\t\tvar scrollThrottler=null;\n\n\t\tthis.forceShow=false;\n\t\tthis.currState=\"NA\";\n\n\t\tfunction scrollListener(){\n\t\t\tif(window.scrollY>420){\n\t\t\t\tself.update({ forceShow: true});\n\t\t\t}else{\n\t\t\t\tself.update({ forceShow: false});\n\t\t\t}\n\t\t}\n\n\t\tfunction checkBackButton(){\n\t\t\tvar currState=(routeStore.getCurrentRoute()||veronica.getCurrentState()).state;\n\t\t\tif(window.history.state.state===\"home\"){\n\t\t\t\tself.update({\n\t\t\t\t\tisBackEnabled:false,\n\t\t\t\t\tcurrState:currState\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tself.update({\n\t\t\t\t\tisBackEnabled:true,\n\t\t\t\t\tcurrState:currState\n\t\t\t\t});\n\t\t\t}\n\n\t\t\twindow.addEventListener('scroll',(e)=>{\n\t\t\t\tif(self.currState==='profile'){\n\t\t\t\t\tif(scrollThrottler){\n\t\t\t\t\t\tclearTimeout(scrollThrottler);\n\t\t\t\t\t}\n\t\t\t\t\tscrollThrottler = setTimeout(scrollListener,300);\n\t\t\t\t}\n\t\t\t},false);\n\t\t}\n\n\t\tthis.isBackEnabled=false;\n\n\t\tthis.goToSearch=function(){\n\t\t\tif(veronica.getCurrentState().state!==\"search\"){\n\t\t\t\tveronica.loc(\"/search\");\n\t\t\t}\n\n\t\t}\n\n\t\tthis.menuClick=function(e){\n\t\t\te.preventDefault();\n\t\t\tif(this.isBackEnabled){\n\t\t\t\thistory.go(-1);\n\t\t\t}else{\n\t\t\t\tnavActions.showModal();\n\t\t\t\tnavActions.openNavbar();\n\t\t\t}\n\t\t}\n\n\t\tthis.on(\"mount\",function(){\n\t\t\tsetTimeout(checkBackButton,300);\n\t\t\trouteStore.subscribe(\"route:changed\",checkBackButton);\n\t\t});\n\n});\nriot.tag2('gp-home', '<h1>home</h1>', '', '', function(opts) {\n\t\tvar userStore=veronica.flux.Stores.getStore(\"UserStore\");\n\n\t\tthis.on(\"mount\",function(){\n\t\t\tif(!userStore.getUserProfile(\"me\"))\n\t\t\t{\n\t\t\t\tveronica.loc(\"/login\",true);\n\t\t\t}else{\n\t\t\t\twindow.scrollTo(0,0);\n\t\t\t}\n\t\t});\n});\nriot.tag2('icon-add', '<svg class=\"icon-add\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('icon-chat', '<svg class=\"icon-chat\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z\"></path><path d=\"M0 0h24v24H0z\" fill=\"none\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('icon-copy', '<svg class=\"icon-copy\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('icon-heart', '<svg class=\"icon-heart\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\" fill=\"#fff\"><path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('icon-pic', '<svg class=\"icon-pic\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('icon-publish', '<svg class=\"icon-publish\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('icon-tick', '<svg class=\"icon-tick\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"></path></svg>', '', '', function(opts) {\n});\nriot.tag2('gp-imagedetails', '<gp-pictureunit isloading=\"{isLoading}\" img=\"{image}\"></gp-pictureunit>', '', '', function(opts) {\n\t\tvar self=this;\n\t\tvar imgActions = veronica.flux.Actions.getAction(\"ImageActions\");\n\t\tvar imgStore = veronica.flux.Stores.getStore(\"ImageStore\");\n\n\t\tthis.isLoading = true;\n\t\tthis.image=null;\n\n\t\tfunction imageFetchSuccess(){\n\t\t\tvar imgDetails=imgStore.getPicDetails(veronica.getCurrentState().data[':imageid']);\n\t\t\tself.update({\n\t\t\t\tisLoading: false,\n\t\t\t\timage: imgDetails\n\t\t\t});\n\t\t\tconsole.log(imgDetails);\n\t\t}\n\n\t\tthis.on('mount',(e)=>{\n\t\t\timgStore.subscribe(\"img:detailsfetch:success\",imageFetchSuccess);\n\t\t\timgActions.fetchImage(veronica.getCurrentState().data[':imageid']);\n\t\t});\n\n\t\tthis.on('unmount',(e)=>{\n\t\t\timgStore.unsubscribe(\"img:detailsfetch:success\",imageFetchSuccess);\n\t\t})\n});\nriot.tag2('gp-login', '<div class=\"title titlefont\"> KanvasProject </div><div class=\"fblogin\" if=\"{!userProfile}\"><img if=\"{!loading}\" src=\"https://www.takingwings.in/wp-content/plugins/wordpress-social-login/assets/img/32x32/wpzoom/facebook.png\" width=\"200\" onclick=\"{startLoading}\"><material-spinner if=\"{loading}\"></material-spinner></div>', '', '', function(opts) {\n\t\tvar self=this;\n\t\tvar userStore=veronica.flux.Stores.getStore(\"UserStore\");\n\t\tvar userActions=veronica.flux.Actions.getAction(\"UserActions\");\n\t\tvar toastActions=veronica.flux.Actions.getAction(\"ToastActions\");\n\n\t\tthis.userProfile=userStore.getUserProfile(\"me\");\n\t\tthis.loading=false;\n\n\t\tthis.startLoading=function(){\n\t\t\tif(window.FB){\n\t\t\t\tself.update({loading:true});\n\t\t\t\tFB.login(function(res){\n\t\t\t\t\tif(res.status===\"connected\"){\n\t\t\t\t\t\tvar url = '/me?fields=name,email,picture';\n\t          FB.api(url, function (response) {\n\t          \tuserActions.loginUser(response,res);\n\t          });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction logInSuccess(){\n\t\t\ttoastActions.showToast('Login successful',{type:'success'});\n\t\t\tveronica.loc(\"/\",true);\n\t\t}\n\n\t\tfunction logInFailed(){\n\t\t\ttoastActions.showToast('Login failed',{type:'error'});\n\t\t\tself.update({loading:false});\n\t\t}\n\n\t\tthis.on(\"mount\",()=>{\n\t\t\tif(this.userProfile){\n\t\t\t\tveronica.loc(\"/\",true);\n\t\t\t}else{\n\t\t\t\tuserStore.subscribe(\"user:login:success\", logInSuccess);\n\t\t\t\tuserStore.subscribe(\"user:login:failed\", logInFailed);\n\t\t\t}\n\t\t});\n\n\t\tthis.on(\"unmount\",()=>{\n\t\t\tuserStore.unsubscribe(\"user:login:success\", logInSuccess);\n\t\t\tuserStore.unsubscribe(\"user:login:failed\", logInFailed);\n\t\t});\n});\nriot.tag2('gp-modal', '<div class=\"modal {isModalShown?\\'opened\\':\\'\\'}\" onclick=\"{closeModal}\"></div>', '', '', function(opts) {\n\t\tvar self=this;\n\n\t\tvar navActions=veronica.flux.Actions.getAction(\"NavigationActions\");\n\t\tvar navStore=veronica.flux.Stores.getStore(\"NavigationStore\");\n\n\t\tthis.isModalShown=false;\n\n\t\tthis.closeModal=function(e){\n\t\t\tnavActions.hideModal();\n\t\t}\n\n\t\tthis.on(\"mount\",function(e){\n\t\t\tnavStore.subscribe(\"nav:modalchange\",function(){\n\t\t\t\tself.update({isModalShown:navStore.getModalStatus()});\n\t\t\t});\n\t\t});\n\n\t\tthis.on(\"unmount\",function(e){\n\n\t\t});\n});\nriot.tag2('gp-navbar', '<nav class=\"{isNavBarOpen?\\'opened\\':\\'closed\\'}\" onswipeleft=\"{closeNavBar}\"><div class=\"userinfo\"><img class=\"pic\" width=\"60\" height=\"60\" riot-src=\"{userProfile.user.avatar_url}\"></img><div class=\"name\">{userProfile.user.name}</div></div><div class=\"navcontents\"><div class=\"navlinks\"><a class=\"navlink\" onclick=\"{closeNavBar}\" href=\"/search\"><svg class=\"icon\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"></path></svg><span class=\"text\">Search</span></a><a class=\"navlink\" onclick=\"{closeNavBar}\" href=\"/profile/{userProfile.user.account_id}\"><svg class=\"icon\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M12 5.9c1.16 0 2.1.94 2.1 2.1s-.94 2.1-2.1 2.1S9.9 9.16 9.9 8s.94-2.1 2.1-2.1m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z\"></path></svg><span class=\"text\">Profile</span></a><a class=\"navlink\" onclick=\"{closeNavBar}\" href=\"/draw\"><svg class=\"icon\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34c-.39-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z\"></path></svg><span class=\"text\">New Canvas</span></a></div></div><div class=\"settings\"><a class=\"navlink\" href=\"/search\"><svg class=\"icon\" fill=\"#FFFFFF\" height=\"24\" viewbox=\"0 0 24 24\" width=\"24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z\"></path></svg><span class=\"text\">Logout</span></a></div></nav>', '', '', function(opts) {\n\t\tvar self=this;\n\n\t\tthis.isNavBarOpen=false;\n\n\t\tvar navActions=veronica.flux.Actions.getAction(\"NavigationActions\");\n\t\tvar navStore=veronica.flux.Stores.getStore(\"NavigationStore\");\n\t\tvar userStore=veronica.flux.Stores.getStore(\"UserStore\");\n\t\tvar initTouchPoint=null;\n\n\t\tthis.userProfile = userStore.getUserProfile(\"me\");\n\t\tthis.forcedStyle = '';\n\n\t\tfunction changeNavBarStatus(){\n\t\t\tself.update({\n\t\t\t\tisNavBarOpen:navStore.getNavBarStatus()&&navStore.getModalStatus()\n\t\t\t});\n\t\t\tif(self.isNavBarOpen){\n\t\t\t\tdocument.body.classList.add(\"noscroll\");\n\t\t\t} else {\n\t\t\t\tdocument.body.classList.remove(\"noscroll\");\n\t\t\t}\n\t\t}\n\n\t\tfunction getUserProfile(){\n\t\t\tself.update({userProfile: userStore.getUserProfile(\"me\")});\n\t\t}\n\n\t\tthis.closeNavBar=function(e){\n\t\t\tnavActions.closeNavBar();\n\t\t\tnavActions.hideModal();\n\t\t}\n\n\t\tthis.initTouch = function(e){\n\t\t\tinitTouchPoint = e.touches[0];\n\t\t\tself.update({\n\t\t\t\tforcedStyle: 'transition-duration:0ms'\n\t\t\t});\n\t\t}\n\n\t\tthis.navBarDragging = function(e){\n\t\t\tvar touch = e.touches[0];\n\t\t\tvar delta = touch.clientX - initTouchPoint.clientX;\n\t\t\tif(delta < 1){\n\t\t\t\tself.update({\n\t\t\t\t\tforcedStyle: 'transition-duration:0ms; transform:translateX('+delta+'px)'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.endTouch = function(e){\n\t\t\tself.update({\n\t\t\t\tforcedStyle: ''\n\t\t\t});\n\t\t}\n\n\t\tthis.on(\"mount\",function(){\n\n\t\t\tnavStore.subscribe(\"nav:statuschange\",changeNavBarStatus);\n\t\t\tnavStore.subscribe(\"nav:modalchange\",changeNavBarStatus);\n\t\t\tuserStore.subscribe(\"user:login:success\",getUserProfile);\n\n\t\t});\n\n\t\tthis.on(\"unmount\",function(){\n\t\t\tnavStore.unsubscribe(\"nav:statuschange\",changeNavBarStatus);\n\t\t\tnavStore.unsubscribe(\"nav:modalchange\",changeNavBarStatus);\n\t\t\tuserStore.unsubscribe(\"user:login:success\",getUserProfile);\n\t\t});\n});\nriot.tag2('gp-picture', '<img onclick=\"{showContribute}\" class=\"pic {isloading?\\'loading\\':\\'\\'}\" height=\"{window.innerWidth}\" riot-src=\"{opts.img}\" onload=\"{loaded}\"></img><icon-pic class=\"loader\"></icon-pic><material-button waves-color=\"#000\" class=\"clone {shown:(usedAccountId !== opts.owner.account_id)&&isShowingClone}\" onclick=\"{startClone}\"><span if=\"{isCloning}\">CLONING</span><span if=\"{isCloned}\">CLONED</span><span if=\"{!isCloned&&!isCloning}\">CONTRIBUTE</span></material-button>', '', '', function(opts) {\n\t\tvar self = this;\n\t\tvar imgActions = veronica.flux.Actions.getAction('ImageActions');\n\t\tvar userStore = veronica.flux.Stores.getStore('UserStore');\n\t\tvar imageStore = veronica.flux.Stores.getStore('ImageStore');\n\n\t\tthis.usedAccountId = userStore.getUserProfile().user.account_id;\n\t\tthis.isloading = true;\n\t\tthis.isShowingClone = false;\n\t\tthis.isCloning = false;\n\t\tthis.isCloned = false;\n\t\tthis.isSelfPic = false;\n\n\t\tfunction imgCloneSuccess(){\n\t\t\tself.update({\n\t\t\t\tisCloning: false,\n\t\t\t\tisCloned: true\n\t\t\t});\n\t\t}\n\n\t\tfunction imgCloneFailure(){\n\t\t\tself.update({\n\t\t\t\tisCloning: false,\n\t\t\t\tisCloned: false\n\t\t\t});\n\t\t}\n\n\t\tthis.loaded=function(){\n\t\t\tself.update({isloading: false});\n\t\t}\n\n\t\tthis.showContribute=function(){\n\t\t\tself.update({isShowingClone: !self.isShowingClone});\n\t\t}\n\n\t\tthis.startClone=function(){\n\t\t\tself.update({isCloning: true});\n\t\t\timgActions.cloneImage(veronica.getCurrentState().data[':imageid'], userStore.getSessionId())\n\t\t}\n\n\t\tthis.on('mount',e=>{\n\t\t\tconsole.log(opts.img);\n\t\t\timageStore.subscribe(\"img:clone:success\",imgCloneSuccess);\n\t\t\timageStore.subscribe(\"img:clone:failed\",imgCloneFailure);\n\t\t});\n\n\t\tthis.on('unmount',e=>{\n\t\t\timageStore.unsubscribe(\"img:clone:success\",imgCloneSuccess);\n\t\t\timageStore.unsubscribe(\"img:clone:failed\",imgCloneFailure);\n\t\t});\n});\nriot.tag2('gp-pictureunit', '<gp-picunitheader details=\"{opts.img}\" isloading=\"{opts.isloading}\"></gp-picunitheader><gp-picture img=\"{opts.img.image}\" owner=\"{opts.img}\"></gp-picture><div class=\"desc\" if=\"{!opts.isloading}\"> {opts.img.description} </div><a class=\"taglink\" each=\"{tag in opts.img.tags}\" href=\"/tag/{tag.tag}\">#{tag.tag}</a><gp-stats details=\"{opts.img}\" if=\"{!opts.isloading}\"></gp-stats>', '', '', function(opts) {\n});\nriot.tag2('gp-picunitheader', '<div class=\"picsection\"><img if=\"{!opts.isloading}\" class=\"pic\" src=\"\" height=\"40\" width=\"40\"></img><span if=\"{opts.isloading}\" class=\"picloader\"></span></div><div class=\"namesection\"><a if=\"{!opts.isloading}\" href=\"/profile/{opts.details.account_id}\">prateek</a><span if=\"{!opts.isloading}\" class=\"event-desc\"> owns this image</span><span class=\"nameloader animated-background\" if=\"{opts.isloading}\"></span></div><div class=\"timesection\" if=\"{!opts.isloading}\"> {prettyDate(new Date(),new Date(opts.details.updated_at||opts.details.created_at))} </div>', '', '', function(opts) {\n});\nriot.tag2('gp-stats', '<div class=\"stats\"><div class=\"commentstat stat\"><button class=\"btn-action comment\"><icon-chat class=\"icon icon-comment\"></icon-chat><span class=\"comment-count count\">{opts.details.num_of_comments}</span></button></div><div class=\"likestat stat\"><button class=\"btn-action like\" onclick=\"{likePic}\"><icon-heart class=\"icon icon-like {isPicLiked?\\'liked\\':\\'\\'}\"></icon-heart><span class=\"like-count count\">{likeCount}</span></button><div class=\"likers me\"><img class=\"liker me\" src=\"https://scontent.xx.fbcdn.net/v/t1.0-1/p200x200/13669817_1117113145017292_4920305262041128067_n.jpg?oh=32783654cad84190711280a5c377221d&oe=582970EA\" riot-style=\"transform:{isPicLiked?\\'scale(1) translateX(10px)\\':\\'scale(0) translateX(0px)\\'}; z-index:{5} \"></div><div class=\"likers others {isPicLiked?\\'liked\\':\\'\\'}\"><img class=\"liker\" each=\"{img,index in likers}\" riot-src=\"{img}\" riot-style=\"transform:translateX({(-10*index)-10}px) {isPicLiked&&index===3?\\'scale(0)\\':\\'\\'}; z-index:{4-index}\"></div></div></div>', '', '', function(opts) {\n\t\tvar self = this;\n\t\tvar imgActions = veronica.flux.Actions.getAction('ImageActions');\n\t\tvar userStore = veronica.flux.Stores.getStore('UserStore');\n\n\t\tthis.isPicLiked = false;\n\t\tthis.likers = [\n\t\t\t\"https://scontent.xx.fbcdn.net/v/t1.0-1/p200x200/13669817_1117113145017292_4920305262041128067_n.jpg?oh=32783654cad84190711280a5c377221d&oe=582970EA\",\n\t\t\t\"https://scontent.xx.fbcdn.net/v/t1.0-1/p200x200/13669817_1117113145017292_4920305262041128067_n.jpg?oh=32783654cad84190711280a5c377221d&oe=582970EA\",\n\t\t\t\"https://scontent.xx.fbcdn.net/v/t1.0-1/p200x200/13669817_1117113145017292_4920305262041128067_n.jpg?oh=32783654cad84190711280a5c377221d&oe=582970EA\",\n\t\t\t\"https://scontent.xx.fbcdn.net/v/t1.0-1/p200x200/13669817_1117113145017292_4920305262041128067_n.jpg?oh=32783654cad84190711280a5c377221d&oe=582970EA\"];\n\t\tthis.likeCount = opts.details&&parseInt(opts.details.num_of_likes)||0;\n\n\t\tthis.likePic = function(e){\n\t\t\te.preventDefault();\n\t\t\tself.update({\n\t\t\t\tisPicLiked:!self.isPicLiked,\n\t\t\t\tlikeCount:!self.isPicLiked?self.likeCount+1:self.likeCount-1\n\t\t\t});\n\n\t\t\timgActions.likeImage(opts.details.id,self.isPicLiked,userStore.getSessionId());\n\t\t}\n\n\t\tthis.on('mount',e=>{\n\t\t\tself.update({likeCount : opts.details&&parseInt(opts.details.num_of_likes)||0});\n\t\t})\n});\nriot.tag2('gp-picunit', '<div class=\"userinfo\"></div><div class=\"container-pic\"></div><div class=\"stats\"></div>', '', '', function(opts) {\n});\nriot.tag2('gp-followbutton', '<button class=\"follow {opts.following?\\'following\\':\\'\\'}\"><icon-add if=\"{!opts.following}\"></icon-add><icon-tick if=\"{opts.following}\"></icon-tick><span class=\"text\">{opts.following?\\'following\\':\\'follow\\'}</span></button>', '', '', function(opts) {\n});\n\nriot.tag2('gp-profile', '<div class=\"profilepic {userPic?\\'loaded\\':\\'\\'}\" riot-style=\"{userPic?\\'background-image:url(\\\\\\'\\'+userPic+\\'\\\\\\')\\':\\'\\'};height:{window.innerHeight*.65}px\"><div class=\"username\">{userProfile.user.name}</div><gp-followbutton following=\"{userProfile.is_follower}\" onclick=\"{startFollowingUser}\" if=\"{userProfile&&ownerProfile&&ownerProfile.user.user_id!==userProfile.user.user_id}\"></gp-followbutton></div><div class=\"usercontent\" if=\"{userProfile}\"><material-tabs useline=\"true\" tabs=\"{tabs}\" __selected=\"{selectedTab}\" tabchanged=\"{tabChanged}\"></material-tabs><div class=\"tabcontent tab{selectedTab}\" onswipeleft=\"{incTabsIndex}\" onswiperight=\"{decTabsIndex}\"><div class=\"tab tab-owned\"><div class=\"ownedcontainer\"><a class=\"piclink\" each=\"{pic, index in userProfile.owned_images}\" href=\"/image/{pic.id}\"><img height=\"{(window.innerWidth/3)-2}\" class=\"ownedpic\" riot-src=\"{pic.url}\"></img></a></div></div><div class=\"tab tab-contri\"> Tab2 </div></div></div><div class=\"usercontent\" if=\"{!userProfile}\"><div class=\"loader\"><material-spinner></material-spinner></div></div>', '', '', function(opts) {\n\t\tvar self = this;\n\t\tvar userStore = veronica.flux.Stores.getStore(\"UserStore\");\n\t\tvar userAction = veronica.flux.Actions.getAction(\"UserActions\");\n\t\tvar pid=veronica.getCurrentState().data[':pid'];\n\t\tvar userProfileEventSubscribed=false;\n\t\tvar $tabs=null;\n\n\t\tvar initPoint = null;\n\t\tvar isCancelling = false;\n\n\t\tthis.userProfile = userStore.getUserProfile(pid);\n\t\tthis.ownerProfile = userStore.getUserProfile(\"me\");\n\t\tthis.userPic = null;\n\t\tthis.selectedTab=0;\n\t\tthis.tabs=[\n\t\t\t{title:'OWNED'},\n\t\t\t{title:'CONTRIBUTIONS'}\n\t\t];\n\n\t\tfunction setUserPic(profile){\n\t\t\tvar img = new Image();\n\t\t\timg.onload=function(){\n\t\t\t\tself.update({userPic : img.src});\n\t\t\t}\n\t\t\timg.src=profile.user.full_profile_url;\n\t\t}\n\n\t\tfunction setUserProfile(){\n\t\t\tvar userProfile = userStore.getUserProfile(pid);\n\t\t\tself.update({\n\t\t\t\tuserProfile:userProfile,\n\t\t\t\ttabs:[{title:'OWNED (' + userProfile.owned_images.length + ')'},{title:'CONTRIBUTIONS (' + userProfile.cloned_images.length + ')'}]\n\t\t\t});\n\t\t\tsetUserPic(userStore.getUserProfile(pid));\n\t\t\t$tabs=self.root.querySelector(\"material-tabs\");\n\n\t\t\tsetTimeout(()=>{\n\t\t\t\tself.root.querySelector('.usercontent').addEventListener('touchstart',(e)=>{\n\t\t\t\t\tinitPoint=e.touches[0];\n\t\t\t\t});\n\t\t\t\tself.root.querySelector('.usercontent').addEventListener('touchmove',(e)=>{\n\t\t\t\t\tvar scrollDirectionIntent = Math.abs(initPoint.clientX - e.touches[0].clientX)/Math.abs(initPoint.clientY - e.touches[0].clientY);\n\t\t\t\t\tif(isCancelling || scrollDirectionIntent > 0.8){\n\t\t\t\t\t\tisCancelling = true;\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tself.root.querySelector('.usercontent').addEventListener('touchend',(e)=>{\n\t\t\t\t\tisCancelling = false;\n\t\t\t\t\tinitPoint = null;\n\t\t\t\t});\n\t\t\t},100);\n\n\t\t}\n\n\t\tthis.incTabsIndex = function(e){\n\t\t\tif(this.selectedTab<1){\n\t\t\t\tself.update({selectedTab:this.selectedTab+1});\n\t\t\t\t$tabs._tag.changeTab(this.selectedTab);\n\t\t\t}\n\t\t}\n\t\tthis.decTabsIndex = function(e){\n\t\t\tif(this.selectedTab>0){\n\t\t\t\tself.update({selectedTab:this.selectedTab-1});\n\t\t\t\t$tabs._tag.changeTab(this.selectedTab);\n\t\t\t}\n\t\t}\n\n\t\tthis.tabChanged = function(){\n\t\t\tself.update({selectedTab:$tabs._tag.selected});\n\t\t}\n\n\t\tthis.startFollowingUser = function(){\n\t\t\tuserAction.followUser(pid,self.userProfile.is_follower);\n\t\t}\n\n\t\tthis.on(\"mount\",()=>{\n\t\t\tuserAction.fetchUserProfile(pid, userStore.getSessionId());\n\t\t\t$tabs=this.root.querySelector(\"material-tabs\");\n\t\t\tif(!this.userProfile){\n\t\t\t\tuserProfileEventSubscribed=true;\n\t\t\t\tuserStore.subscribe(\"user:profile:fetched\",setUserProfile);\n\t\t\t}else{\n\t\t\t\tsetUserPic(this.userProfile);\n\t\t\t}\n\n\t\t});\n\n\t\tthis.on(\"unmount\",(e)=>{\n\t\t\tif(userProfileEventSubscribed){\n\t\t\t\tuserStore.unsubscribe(\"user:profile:fetched\",setUserProfile);\n\t\t\t}\n\t\t})\n});\n\nriot.tag2('gp-search', '<input type=\"\" onkeyup=\"{search}\">', '', '', function(opts) {\n\t\tthis.search=function(q){\n\t\t\tfetch(apiBase+'/galleria/search/any/'+q.target.value,{\n\t\t\t\tmode: 'cors',\n\t\t\t\tcredentials: 'include'\n\t\t\t})\n\t\t\t.then(res=>res.json())\n\t\t\t.then(data=>{\n\t\t\t\tconsole.log(data);\n\t\t\t})\n\t\t}\n});\nriot.tag2('gp-toast', '<div class=\"toastcontainer\"></div>', '', '', function(opts) {\n\t\tvar self = this;\n\t\tvar toastStore = veronica.flux.Stores.getStore('ToastStore');\n\t\tvar $tContainer=null;\n\n\t\tfunction showToast(){\n\t\t\tvar toastObj = toastStore.getToastData();\n\t\t\tvar toastDom = document.createElement('div');\n\t\t\ttoastDom.setAttribute('class','toast '+toastObj.data.type);\n\t\t\ttoastDom.innerText = toastObj.text;\n\t\t\t$tContainer.appendChild(toastDom);\n\t\t}\n\n\t\tthis.on('mount',(e)=>{\n\t\t\t$tContainer=this.root.querySelector('.toastcontainer');\n\t\t\ttoastStore.subscribe('toast:show',showToast);\n\t\t});\n\n\t\tthis.on('unmount',(e)=>{\n\t\t\ttoastStore.unsubscribe('toast:show',showToast);\n\t\t});\n});\nriot.tag2('material-dialog', '<div if=\"{opts.shown}\"><div class=\"bg\"></div><div class=\"dialog {shown:opts.shown}\"><div class=\"title\">{opts.title}</div><div class=\"desc\"><yield></yield></div><div class=\"actions\"><material-button class=\"action\" each=\"{action in opts.actions}\" onclick=\"{actionSelected}\">{action}</material-button></div></div></div>', '', '', function(opts) {\n\t\tvar self=this;\n\n\t\tthis.on('mount',(e)=>{\n\n\t\t\tdocument.body.appendChild(this.root);\n\t\t});\n\n\t\tthis.actionSelected=function(e){\n\t\t\tif(self.opts.onaction){\n\t\t\t\tself.opts.onaction(e.target.parentElement.parentElement.innerText.trim());\n\t\t\t}\n\t\t}\n});\nriot.tag2('material-progressbar', '<div class=\"bar\"><div class=\"progress {opts.moving?\\'moving\\':\\'\\'}\" riot-style=\"width:{opts.progress*100}%\"></div></div>', '', '', function(opts) {\n});\nfunction UserAction(){\n\n\tthis.fetchUserProfile = function(uid, sid){\n\t\tfetch(apiBase+\"/user/profile/details/\"+uid,{\n\t\t\tmode: 'cors',\n\t\t\tcredentials: 'include'\n\t\t})\n\t\t.then(handleErrors)\n\t\t.then(res=>res.json())\n\t\t.then(data=>{\n\t\t\tthis.Dispatcher.trigger(\"user:fetchprofile:success\",data);\n\t\t}).catch(e=>{\n\t\t\tthis.Dispatcher.trigger(\"user:fetchprofile:failed\",e);\n\t\t});\n\t}\n\n\tthis.loginUser = (fbprofile,oauth)=>{\n\t\tvar user={};\n\t\tfetch(window.apiBase+\"/user/signIn\",{\n\t\t\theaders:window.defaultHeaders,\n\t\t\tmethod:\"POST\",\n\t\t\tmode: 'cors',\n\t\t\tcredentials: 'include',\n\t\t\tbody:JSON.stringify(\n\t\t\t{\n\t\t\t  \"user_details\": {\n\t\t\t\t\"avatar_url\": fbprofile.picture.data.url,\n\t\t\t\t\"name\": fbprofile.name,\n\t\t\t\t\"email\": fbprofile.email,\n\t\t\t\t\"id\": fbprofile.id\n\t\t\t  },\n\t\t\t  \"oauth_credentials\": {\n\t\t\t\t\"oauth_response\": {\n\t\t\t  \t\"access_token\": oauth.authResponse.accessToken\n\t\t\t\t}\n\t\t\t  }\n\t\t\t})\n\t\t})\n\t\t.then(handleErrors)\n\t\t.then(res=>res.json())\n\t\t.then(data=>{\n\t\t\tthis.Dispatcher.trigger(\"user:login:success\",data);\n\t\t}).catch(e=>{\n\t\t\tthis.Dispatcher.trigger(\"user:login:failure\",{data:e});\n\t\t})\n\t}\n\n    this.setUserProfile = function(profile){\n        this.Dispatcher.trigger(\"user:setprofile\",{profile:profile});\n    }\n\n    this.followUser = function(userId){\n    \tfetch(window.apiBase+\"/user/addFollower\",{\n    \t\theaders:window.defaultHeaders,\n    \t\tmethod:\"POST\",\n    \t\tmode: 'cors',\n    \t\tcredentials: 'include',\n    \t\tbody:JSON.stringify(\n    \t\t{\n    \t\t  'follower_account_id': userId\n    \t\t})\n    \t})\n    \t.then(handleErrors)\n    \t.then(res=>res.json())\n    \t.then(data=>{\n    \t\tthis.Dispatcher.trigger(\"user:followed:success\",{data:data, id:userId});\n    \t}).catch(e=>{\n    \t\tthis.Dispatcher.trigger(\"user:followed:failure\",{data:e});\n    \t})\n    }\n\n}\n\nveronica.flux.Actions.createAction(\"UserActions\",UserAction); \n \nfunction NavigationActions(){\n    this.openNavbar=function(){\n        this.Dispatcher.trigger(\"nav:opennavbar\",{});\n    }\n\n    this.closeNavBar=function(){\n        this.Dispatcher.trigger(\"nav:closenavbar\",{});\n    }\n\n    this.showModal=function(){\n    \tthis.Dispatcher.trigger(\"nav:openmodal\",{});\t\n    }\n\n    this.hideModal=function(){\n    \tthis.Dispatcher.trigger(\"nav:closemodal\",{});\t\n    }\n   \n}\n\nveronica.flux.Actions.createAction(\"NavigationActions\",NavigationActions); \n \nfunction ImageActions(){\n    this.saveImage = function(imgId, img,tags,description,sessionId){\n        fetch(window.apiBase+\"/image/save\",{\n            headers: Object.assign({},window.defaultHeaders,{'x-session-id': sessionId}),\n            method: \"POST\",\n            mode: 'cors',\n            credentials: 'include',\n            body: JSON.stringify({\n              \"image\": LZW.encode(img),\n              \"tags\": [\n                \"string\"\n              ],\n              \"description\": \"string\",\n              \"title\": \"string\",\n              \"image_id\": imgId\n            })\n        })\n        .then(handleErrors)\n        .then(res=>res.json())\n        .then(data=>{\n          this.Dispatcher.trigger(\"img:save:success\",data);  \n        }).catch(e=>{\n          this.Dispatcher.trigger(\"img:save:failed\",{});  \n        });\n    }\n\n    this.likeImage = function(imageId, liked, sessionId){\n      fetch(window.apiBase+'/image/'+imageId+'/like',{\n        headers: Object.assign({},window.defaultHeaders,{'x-session-id': sessionId}),\n        method: \"POST\",\n        mode: 'cors',\n        credentials: 'include',\n        body:''\n      })\n      .then(handleErrors)\n      .then(res=>res.json())\n      .then(data=>{\n        console.log(data);\n      });\n    }\n\n    this.cloneImage = function(imageId, sessionId){\n      var fetchPromise = fetch(window.apiBase+'/image/clone',{\n        headers: Object.assign({},window.defaultHeaders,{'x-session-id': sessionId}),\n        method: \"POST\",\n        mode: 'cors',\n        credentials: 'include',\n        body:JSON.stringify({ image_id: imageId})\n      })\n      .then(res=>{\n        if(res.status!==200){\n          throw newError('Image Cloning failed');\n        }\n        return res.json()\n      })\n      .then(data=>{\n        this.Dispatcher.trigger(\"img:clone:success\",data);\n      })\n      .catch(e=>{\n        this.Dispatcher.trigger(\"img:clone:failed\",e);\n      })\n    }\n\n    this.publishImage = function(imageId){\n      //implement fetch here\n    }\n\n    this.fetchImage = function (imageId){\n      fetch(apiBase+\"/image/details/\"+imageId,{\n        mode: 'cors',\n        credentials: 'include'\n      })\n      .then(handleErrors)\n      .then(res=>res.json())\n      .then(data=>{\n        this.Dispatcher.trigger(\"img:detailsfetch:success\",data);  \n      }).catch(e=>{\n        this.Dispatcher.trigger(\"img:detailsfetch:failed\",{});  \n      });\n      \n    }\n}\n\nveronica.flux.Actions.createAction(\"ImageActions\",ImageActions); \n \nfunction ToastActions(){\n    this.showToast = function(text,opts){\n        this.Dispatcher.trigger(\"toast:show\",{text:text,data:opts});\n    }\n\n    this.showSnackBar = function(text,opts){\n        this.Dispatcher.trigger(\"snackbar:show\",{text:text,data:opts});\n    }\n   \n}\n\nveronica.flux.Actions.createAction(\"ToastActions\",ToastActions); \n \nfunction UserStore(){\n\n    var sessionId=localStorage.sid||null;\n    var users={};\n\n    users[\"me\"]=localStorage.user&&JSON.parse(localStorage.user)||null;\n    \n    if(users[\"me\"]){\n        users[users[\"me\"].account_id]=users[\"me\"];    \n    }\n    \n    //Register for actions\n\n    this.Dispatcher.register(\"user:login:success\",(data)=>{\n        //sid for all further requests\n        sessionId=data.session_id;\n        \n        //start caching big image \n        var img=new Image();\n        img.src=data.profile_details.user.full_profile_url;\n        \n        \n        users[\"me\"]=data.profile_details;\n        users[users[\"me\"].account_id]=users[\"me\"];\n        localStorage.sid = sessionId;\n        localStorage.user = JSON.stringify(users[\"me\"]);\n        this.emit(\"user:login:success\");\n    });\n\n    this.Dispatcher.register(\"user:login:failure\",(data)=>{\n        this.emit(\"user:login:failure\");\n    });\n\n    this.Dispatcher.register(\"user:fetchprofile:success\",(data)=>{\n        users[data.user.account_id]=data;\n        this.emit(\"user:profile:fetched\");\n    });\n\n    this.getUserProfile=function(uid){\n        return users[uid];\n    }\n\n    this.getSessionId=function(){\n        return sessionId;\n    }\n\n}\n \n//creating an store \nveronica.flux.Stores.createStore(\"UserStore\",UserStore);\nfunction RouteStore(){\n    var prevRoute=null;\n    var currRoute=null;\n    var self=this;\n\n    window.addEventListener(\"popstate\",function(){\n        prevRoute=currRoute;\n        currRoute=veronica.getCurrentState();\n        self.emit(\"route:changed\");\n    });\n\n\n    /* hack for push state */\n    (function(history){\n        var pushState = history.pushState;\n        var replaceState = history.replaceState;\n        history.pushState = function(state) {\n            if (typeof history.onpushstate == \"function\") {\n                history.onpushstate({state: state});\n            }\n            pushState.apply(history, arguments);\n            prevRoute=currRoute;\n            currRoute=state;\n            self.emit(\"route:changed\");\n        }\n        \n        history.replaceState = function(state) {\n            replaceState.apply(history, arguments);\n            prevRoute=currRoute;\n            currRoute=state;\n            self.emit(\"route:changed\");\n        }\n    })(window.history);\n\n    this.getPrevoute=function(){\n        return prevRoute;\n    }\n\n    this.getCurrentRoute=function(){\n        return currRoute;\n    }\n\n}\n \n//creating an store \nveronica.flux.Stores.createStore(\"RouteStore\",RouteStore);  \nfunction NavigationStore(){\n    var self=this;\n    var isNavBarOpen=false;\n    var isModalShow=false;\n\n    //Register for actions\n    this.Dispatcher.register(\"nav:opennavbar\",openNavBar);\n    this.Dispatcher.register(\"nav:closenavbar\",closeNavBar);\n    this.Dispatcher.register(\"nav:openmodal\",openModal);\n    this.Dispatcher.register(\"nav:closemodal\",closeModal);\n\n    function openNavBar(){\n        isNavBarOpen=true;\n        self.emit(\"nav:statuschange\");\n    }\n\n    function closeNavBar(){\n        isNavBarOpen=false;\n        self.emit(\"nav:statuschange\");\n    }\n\n    function openModal(){\n        isModalShow=true;\n        self.emit(\"nav:modalchange\");\n    }\n\n    function closeModal(){\n        isModalShow=false;\n        self.emit(\"nav:modalchange\");\n    }\n\n    this.getNavBarStatus=function(){\n        return isNavBarOpen;\n    }\n\n    this.getModalStatus=function(){\n        return isModalShow;\n    }\n\n}\n \n//creating an store \nveronica.flux.Stores.createStore(\"NavigationStore\",NavigationStore);  \nfunction ImageStore() {\n  var self = this;\n  var currPic=null;\n  var imgs={};\n  //Register for actions\n  this.Dispatcher.register(\"img:save:success\", (data)=>{\n    currPic = data;\n    this.emit(\"img:save:success\");\n  });\n\n  this.Dispatcher.register(\"img:save:failed\", (data)=>{\n    this.emit(\"img:save:failed\");\n  });\n\n  this.Dispatcher.register(\"img:clone:success\", (data)=>{\n    this.emit(\"img:clone:success\");\n  });\n\n  this.Dispatcher.register(\"img:clone:failed\", (data)=>{\n    this.emit(\"img:clone:failed\");\n  });\n\n  this.Dispatcher.register(\"img:detailsfetch:success\", (data)=>{\n    imgs[data.id]=data;\n    this.emit(\"img:detailsfetch:success\");\n  });\n\n  this.Dispatcher.register(\"img:detailsfetch:failed\", (data)=>{\n    this.emit(\"img:detailsfetch:failed\");\n  });\n\n  this.getPicDetails=function(imageId){\n    return imgs[imageId];\n  }\n\n  this.getCurrentPicId=function(){\n    return currPic;\n  }\n}\n\n//creating an store \nveronica.flux.Stores.createStore(\"ImageStore\", ImageStore);\n\nfunction ToastStore(){\n    var self=this;\n\n    var toastData=null;\n\n    this.Dispatcher.register('toast:show',(data)=>{\n    \ttoastData = data;\n    \tthis.emit('toast:show');\n    });\n\n    this.getToastData = function(){\n    \treturn toastData;\n    }\n}\n \n//creating an store \nveronica.flux.Stores.createStore(\"ToastStore\",ToastStore);  "]}