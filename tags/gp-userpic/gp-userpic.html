<gp-userpic>
	<div class="userinfo">
		<div class="piccontainer">
			<img class="userpic" height="50" width="50" src="{this.opts.data.user_avatar_url}"></img>	
		</div>
		<a href="/user/{this.opts.data.account_id}" class="username">{this.opts.data.user_name}</a>
		<span class="time">15m</span>
	</div>
	<div class="painting" onclick={toggleCopy}>
		<img class="img-painting" src={window.ip+"/image/"+this.opts.data.image_id+"/data"}/>
		<button if={!this.opts.data.is_cloned} class="copy hidden" onclick={cloneImage}>
			<svg xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24">
			    <path d="M0 0h24v24H0z" fill="none"/>
			    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
			</svg>
		</button>
	</div>
	<script>
		var showingCopy=false;
		var $copy=this.root.querySelector(".copy");
		this.on("mount",function(e){
			$copy=this.root.querySelector(".copy");
		});
		this.toggleCopy=function(){
			if(!showingCopy){
				$copy&&$copy.classList.remove("hidden");
			}
			else{
				$copy&&$copy.classList.add("hidden");	
			}
			showingCopy=!showingCopy;
		}
		this.cloneImage=function(e){
			e.preventDefault();
			fetch(window.ip+"/galleria/clone?image_id="+this.opts.data.image_id,{
				headers: { 'x-account-id': window.uid },
				method: "POST"
			})
			.then(res=>res.json())
			.then(data=>{
				console.log(data);
				if(data.image_id){
					veronica.loc("/editpr/"+data.image_id);
				}
			});
		}
	</script>
</gp-userpic>